{ UNPAIR ; NIL (pair address (pair (pair address nat) (pair mutez nat))) ; PAIR ; PAIR ; LEFT (list (pair address (pair (pair address nat) (pair mutez nat)))) ; LOOP_LEFT { UNPAIR ; UNPAIR ; DUP 3 ; CDR ; CDR ; CAR ; DUP 3 ; COMPARE ; GE ; IF { SWAP ; DROP ; SWAP ; DROP ; RIGHT (pair (pair (list (pair address (pair (pair address nat) (pair mutez nat)))) nat) (pair (big_map nat (pair address (pair (pair address nat) (pair mutez nat)))) (pair (option (pair (pair address bool) (option address))) (pair nat unit)))) } { DUP 3 ; CAR ; DUP 3 ; GET ; IF_NONE { DIG 2 ; PUSH nat 1 ; DIG 3 ; ADD ; DIG 2 ; PAIR ; PAIR ; LEFT (list (pair address (pair (pair address nat) (pair mutez nat)))) } { DIG 3 ; PUSH nat 1 ; DIG 4 ; ADD ; DIG 3 ; DIG 3 ; CONS ; PAIR ; PAIR ; LEFT (list (pair address (pair (pair address nat) (pair mutez nat)))) } } } } 